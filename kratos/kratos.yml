version: v1.1.0
dsn: postgres://postgres:postgres@postgres:5432/kratos_db?sslmode=disable

session:
  whoami:
    tokenizer:
      templates:
        default: # This name MUST match your ?tokenize_as=query_param
          ttl: 1h
          # Where Kratos finds the private key to sign the JWT
          jwks_url: file:///etc/config/kratos/jwks.json 
          # How Kratos maps user traits (email, etc.) into JWT claims
          claims_mapper_url: file:///etc/config/kratos/claims.jsonnet 


serve:
  public:
    base_url: http://localhost:4433/
    cors:
      enabled: true
      allowed_origins:
        - http://localhost:3000
      allowed_methods:
        - POST
        - GET
        - PUT
        - PATCH
        - DELETE
      allowed_headers:
        - Authorization
        - Cookie
        - Content-Type
      exposed_headers:
        - Content-Type
        - Set-Cookie
  admin:
    base_url: http://kratos:4434/

oauth2_provider:
  url: http://hydra:4445

selfservice:
  default_browser_return_url: http://localhost:3000/ # Your App/UI
  methods:
    password: { enabled: true }
    oidc:
      enabled: true
      config:
        providers:
          - id: google
            provider: google
            client_id: 
            client_secret: 
            mapper_url: file:///etc/config/kratos/google.jsonnet # Path to your file
            scope:
              - email
              - profile
  flows:
    registration:
      ui_url: http://localhost:3000/registration
      after:
        password: { hooks: [{ hook: session }] }
        oidc: # After Google/OIDC registration...
          hooks:
            - hook: session # ...automatically create a login session
    login:
      ui_url: http://localhost:3000/login
    error:
      ui_url: http://localhost:3000/error
    settings:
      ui_url: http://localhost:3000/settings

log: { level: debug }
identity:
  default_schema_id: default
  schemas:
    - id: default
      url: file:///etc/config/kratos/identity.schema.json
